(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.imageSmoothingEnabled = false;
const CARD_W = 120;
const CARD_H = 200;
const CARD_GAP = 10;
const CARD_ROWS = 2;
const CARD_COLS = 4;
let cardGrid = new Array(CARD_COLS * CARD_ROWS / 2).fill('');
let compare = [];
let mouseX = 0;
let mouseY = 0;
const cards = [{
  id: 0,
  type: 'Elements',
  name: 'Earth',
  open: false,
  shown: true
}, {
  id: 1,
  type: 'Elements',
  name: 'Water',
  open: false,
  shown: true
}, {
  id: 2,
  type: 'Elements',
  name: 'Air',
  open: false,
  shown: true
}, {
  id: 3,
  type: 'Elements',
  name: 'Fire',
  open: false,
  shown: true
}, {
  id: 4,
  type: 'Planets',
  name: 'Sol',
  equality: 'Aurum',
  open: false,
  shown: true
}, {
  id: 5,
  type: 'Planets',
  name: 'Luna',
  equality: 'Argentum',
  open: false,
  shown: true
}, {
  id: 6,
  type: 'Planets',
  name: 'Venus',
  equality: 'Cuprum',
  open: false,
  shown: true
}, {
  id: 7,
  type: 'Planets',
  name: 'Mars',
  equality: 'Ferrum',
  open: false,
  shown: true
}, {
  id: 8,
  type: 'Planets',
  name: 'Iupiter',
  equality: 'Stannum',
  open: false,
  shown: true
}, {
  id: 9,
  type: 'Planets',
  name: 'Mercurius',
  equality: 'Hydrargyrum',
  open: false,
  shown: true
}, {
  id: 10,
  type: 'Planets',
  name: 'Saturnus',
  equality: 'Plumbum',
  open: false,
  shown: true
}, {
  id: 11,
  type: 'Planets',
  name: 'Terra',
  open: false,
  shown: true
}, {
  id: 12,
  type: 'Planets',
  name: 'Uranus',
  open: false,
  shown: true
}, {
  id: 13,
  type: 'Planets',
  name: 'Neptunus',
  open: false,
  shown: true
}, {
  id: 14,
  type: 'Planets',
  name: 'Pluto',
  open: false,
  shown: true
}, {
  id: 15,
  type: 'Metalls',
  name: 'Copper',
  open: false,
  shown: true
} // TODO: processes, mundanes, compound
];

function cardsReset() {
  let i = 0;

  do {
    let randomCard = getRandomCard();

    if (!cardGrid.find(item => item.id === randomCard.id)) {
      cardGrid[i] = randomCard;
      i++;
    }
  } while (i < CARD_COLS * CARD_ROWS / 2);

  cardGrid = messCardsArray(cardGrid.concat(cardGrid.map(object => ({ ...object
  }))));
}

function messCardsArray(arr) {
  var j, temp;

  for (var i = arr.length - 1; i > 0; i--) {
    j = Math.floor(Math.random() * (i + 1));
    temp = arr[j];
    arr[j] = arr[i];
    arr[i] = temp;
  }

  return arr;
}

function getRandomCard() {
  return cards[Math.floor(Math.random() * cards.length)];
}

function rowColToArrayIndex(col, row) {
  return col + CARD_COLS * row;
}

function drawCards() {
  for (let eachRow = 0; eachRow < CARD_ROWS; eachRow++) {
    for (let eachCol = 0; eachCol < CARD_COLS; eachCol++) {
      let arrayIndex = rowColToArrayIndex(eachCol, eachRow);

      if (cardGrid[arrayIndex] && cardGrid[arrayIndex].shown) {
        if (!cardGrid[arrayIndex].open) {
          drawCardBack(CARD_W * eachCol + CARD_GAP * eachCol, CARD_H * eachRow + CARD_GAP * eachRow, CARD_W, CARD_H, 'gray');
        } else {
          drawCardFront(CARD_W * eachCol + CARD_GAP * eachCol, CARD_H * eachRow + CARD_GAP * eachRow, CARD_W, CARD_H, '#eeeeee', cardGrid[arrayIndex]);
        }
      }
    }
  }
}

function drawCardBack(x, y, width, height, color) {
  ctx.beginPath();
  ctx.fillStyle = color;
  ctx.fillRect(x, y, width, height);
  ctx.closePath();
  ctx.fill();
}

function drawCardFront(x, y, width, height, color, card) {
  ctx.beginPath();
  ctx.fillStyle = color;
  ctx.fillRect(x, y, width, height);
  ctx.closePath();
  ctx.fill();
  ctx.strokeStyle = 'black';
  ctx.lineWidth = 4;

  if (card.id === 0) {
    // draw Earth
    ctx.beginPath();
    ctx.moveTo(x + CARD_W / 2, y + CARD_H - CARD_H / 3.5);
    ctx.lineTo(x + CARD_W / 10, y + CARD_H / 3.5);
    ctx.lineTo(x + CARD_W - CARD_W / 10, y + CARD_H / 3.5);
    ctx.closePath();
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x + CARD_W / 5, y + CARD_H - CARD_H / 2.5);
    ctx.lineTo(x + CARD_W - CARD_W / 5, y + CARD_H - CARD_H / 2.5);
    ctx.stroke();
  }

  if (card.id === 1) {
    // draw Water
    ctx.beginPath();
    ctx.moveTo(x + CARD_W / 2, y + CARD_H - CARD_H / 3.5);
    ctx.lineTo(x + CARD_W / 10, y + CARD_H / 3.5);
    ctx.lineTo(x + CARD_W - CARD_W / 10, y + CARD_H / 3.5);
    ctx.closePath();
    ctx.stroke();
  }

  if (card.id === 2) {
    // draw Air
    ctx.beginPath();
    ctx.moveTo(x + CARD_W / 2, y + CARD_H / 3.5);
    ctx.lineTo(x + CARD_W / 10, y + CARD_H - CARD_H / 3.5);
    ctx.lineTo(x + CARD_W - CARD_W / 10, y + CARD_H - CARD_H / 3.5);
    ctx.closePath();
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x + CARD_W / 5, y + CARD_H / 2.5);
    ctx.lineTo(x + CARD_W - CARD_W / 5, y + CARD_H / 2.5);
    ctx.stroke();
  }

  if (card.id === 3) {
    // draw Fire
    ctx.beginPath();
    ctx.moveTo(x + CARD_W / 2, y + CARD_H / 3.5);
    ctx.lineTo(x + CARD_W / 10, y + CARD_H - CARD_H / 3.5);
    ctx.lineTo(x + CARD_W - CARD_W / 10, y + CARD_H - CARD_H / 3.5);
    ctx.closePath();
    ctx.stroke();
  }

  ctx.beginPath();
  ctx.font = '13px verdana';
  ctx.textAlign = 'center';
  ctx.fillStyle = 'black';
  ctx.fillText(card.type, x + CARD_W / 2, y + 30);
  ctx.font = 'bold 15px verdana';
  ctx.fillText(card.name, x + CARD_W / 2, y + CARD_H - 20);
  ctx.closePath();
}

function drawAll() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawCards();
}

function updateMousePos(evt) {
  const rect = canvas.getBoundingClientRect();
  const root = document.documentElement;
  mouseX = evt.clientX - rect.left - root.scrollLeft;
  mouseY = evt.clientY - rect.top - root.scrollTop;
  let cardColumnGap = mouseX / (CARD_W + CARD_GAP);
  let cardRowGap = mouseY / (CARD_H + CARD_GAP);
  let cardColumn = Math.floor(cardColumnGap);
  let cardRow = Math.floor(cardRowGap);
  let col = cardColumn + (100 - CARD_GAP * 100 / CARD_W) / 100;
  let row = cardRow + (100 - CARD_GAP * 100 / CARD_H) / 100;
  if (col < cardColumnGap || row < cardRowGap) return;
  let cardUnderClick = rowColToArrayIndex(cardColumn, cardRow);

  if (cardColumn >= 0 && cardColumn < CARD_COLS && cardRow >= 0 && cardRow < CARD_ROWS) {
    if (cardGrid[cardUnderClick]) {
      compareCards(cardUnderClick);
      drawAll();
    }
  }
}

function compareCards(card) {
  if (compare.length === 2) return;
  compare.push(card);
  cardGrid[card].open = true;

  if (compare.length === 2) {
    if (cardGrid[compare[0]].id === cardGrid[compare[1]].id) {
      setTimeout(function () {
        // cardGrid[compare[0]].shown = false;
        // cardGrid[compare[1]].shown = false;
        compare = [];
        drawAll();
      }, 1000);
    } else {
      setTimeout(function () {
        cardGrid[compare[0]].open = false;
        cardGrid[compare[1]].open = false;
        compare = [];
        drawAll();
      }, 1000);
    }
  }
}

window.onload = function () {
  canvas.addEventListener('click', updateMousePos);
  cardsReset();
  drawAll();
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJlczYvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsY0FBVCxDQUF3QixNQUF4QixDQUFmO0FBQ0EsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLFVBQVAsQ0FBa0IsSUFBbEIsQ0FBWjtBQUNBLE1BQU0sQ0FBQyxxQkFBUCxHQUErQixLQUEvQjtBQUVBLE1BQU0sTUFBTSxHQUFHLEdBQWY7QUFDQSxNQUFNLE1BQU0sR0FBRyxHQUFmO0FBQ0EsTUFBTSxRQUFRLEdBQUcsRUFBakI7QUFDQSxNQUFNLFNBQVMsR0FBRyxDQUFsQjtBQUNBLE1BQU0sU0FBUyxHQUFHLENBQWxCO0FBQ0EsSUFBSSxRQUFRLEdBQUcsSUFBSSxLQUFKLENBQVUsU0FBUyxHQUFHLFNBQVosR0FBd0IsQ0FBbEMsRUFBcUMsSUFBckMsQ0FBMEMsRUFBMUMsQ0FBZjtBQUNBLElBQUksT0FBTyxHQUFHLEVBQWQ7QUFFQSxJQUFJLE1BQU0sR0FBRyxDQUFiO0FBQ0EsSUFBSSxNQUFNLEdBQUcsQ0FBYjtBQUVBLE1BQU0sS0FBSyxHQUFHLENBQ2Q7QUFBRSxFQUFBLEVBQUUsRUFBRyxDQUFQO0FBQVUsRUFBQSxJQUFJLEVBQUUsVUFBaEI7QUFBNEIsRUFBQSxJQUFJLEVBQUUsT0FBbEM7QUFBMkMsRUFBQSxJQUFJLEVBQUUsS0FBakQ7QUFBd0QsRUFBQSxLQUFLLEVBQUU7QUFBL0QsQ0FEYyxFQUVkO0FBQUUsRUFBQSxFQUFFLEVBQUcsQ0FBUDtBQUFVLEVBQUEsSUFBSSxFQUFFLFVBQWhCO0FBQTRCLEVBQUEsSUFBSSxFQUFFLE9BQWxDO0FBQTJDLEVBQUEsSUFBSSxFQUFFLEtBQWpEO0FBQXdELEVBQUEsS0FBSyxFQUFFO0FBQS9ELENBRmMsRUFHZDtBQUFFLEVBQUEsRUFBRSxFQUFHLENBQVA7QUFBVSxFQUFBLElBQUksRUFBRSxVQUFoQjtB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ZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWUnKTtcclxuY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbmNhbnZhcy5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcclxuXHJcbmNvbnN0IENBUkRfVyA9IDEyMDtcclxuY29uc3QgQ0FSRF9IID0gMjAwO1xyXG5jb25zdCBDQVJEX0dBUCA9IDEwO1xyXG5jb25zdCBDQVJEX1JPV1MgPSAyO1xyXG5jb25zdCBDQVJEX0NPTFMgPSA0O1xyXG5sZXQgY2FyZEdyaWQgPSBuZXcgQXJyYXkoQ0FSRF9DT0xTICogQ0FSRF9ST1dTIC8gMikuZmlsbCgnJyk7XHJcbmxldCBjb21wYXJlID0gW107XHJcblxyXG5sZXQgbW91c2VYID0gMDtcclxubGV0IG1vdXNlWSA9IDA7XHJcblxyXG5jb25zdCBjYXJkcyA9IFtcclxueyBpZDogIDAsIHR5cGU6ICdFbGVtZW50cycsIG5hbWU6ICdFYXJ0aCcsIG9wZW46IGZhbHNlLCBzaG93bjogdHJ1ZSB9LFxyXG57IGlkOiAgMSwgdHlwZTogJ0VsZW1lbnRzJywgbmFtZTogJ1dhdGVyJywgb3BlbjogZmFsc2UsIHNob3duOiB0cnVlIH0sXHJcbnsgaWQ6ICAyLCB0eXBlOiAnRWxlbWVudHMnLCBuYW1lOiAnQWlyJywgb3BlbjogZmFsc2UsIHNob3duOiB0cnVlIH0sXHJcbnsgaWQ6ICAzLCB0eXBlOiAnRWxlbWVudHMnLCBuYW1lOiAnRmlyZScsIG9wZW46IGZhbHNlLCBzaG93bjogdHJ1ZSB9LFxyXG57IGlkOiAgNCwgdHlwZTogJ1BsYW5ldHMnLCBuYW1lOiAnU29sJywgZXF1YWxpdHk6ICdBdXJ1bScsIG9wZW46IGZhbHNlLCBzaG93bjogdHJ1ZSB9LFxyXG57IGlkOiAgNSwgdHlwZTogJ1BsYW5ldHMnLCBuYW1lOiAnTHVuYScsIGVxdWFsaXR5OiAnQXJnZW50dW0nLCBvcGVuOiBmYWxzZSwgc2hvd246IHRydWUgfSxcclxueyBpZDogIDYsIHR5cGU6ICdQbGFuZXRzJywgbmFtZTogJ1ZlbnVzJywgZXF1YWxpdHk6ICdDdXBydW0nLCBvcGVuOiBmYWxzZSwgc2hvd246IHRydWUgfSxcclxueyBpZDogIDcsIHR5cGU6ICdQbGFuZXRzJywgbmFtZTogJ01hcnMnLCBlcXVhbGl0eTogJ0ZlcnJ1bScsIG9wZW46IGZhbHNlLCBzaG93bjogdHJ1ZSB9LFxyXG57IGlkOiAgOCwgdHlwZTogJ1BsYW5ldHMnLCBuYW1lOiAnSXVwaXRlcicsIGVxdWFsaXR5OiAnU3Rhbm51bScsIG9wZW46IGZhbHNlLCBzaG93bjogdHJ1ZSB9LFxyXG57IGlkOiAgOSwgdHlwZTogJ1BsYW5ldHMnLCBuYW1lOiAnTWVyY3VyaXVzJywgZXF1YWxpdHk6ICdIeWRyYXJneXJ1bScsIG9wZW46IGZhbHNlLCBzaG93bjogdHJ1ZSB9LFxyXG57IGlkOiAxMCwgdHlwZTogJ1BsYW5ldHMnLCBuYW1lOiAnU2F0dXJudXMnLCBlcXVhbGl0eTogJ1BsdW1idW0nLCBvcGVuOiBmYWxzZSwgc2hvd246IHRydWUgfSxcclxueyBpZDogMTEsIHR5cGU6ICdQbGFuZXRzJywgbmFtZTogJ1RlcnJhJywgb3BlbjogZmFsc2UsIHNob3duOiB0cnVlIH0sXHJcbnsgaWQ6IDEyLCB0eXBlOiAnUGxhbmV0cycsIG5hbWU6ICdVcmFudXMnLCBvcGVuOiBmYWxzZSwgc2hvd246IHRydWUgfSxcclxueyBpZDogMTMsIHR5cGU6ICdQbGFuZXRzJywgbmFtZTogJ05lcHR1bnVzJywgb3BlbjogZmFsc2UsIHNob3duOiB0cnVlIH0sXHJcbnsgaWQ6IDE0LCB0eXBlOiAnUGxhbmV0cycsIG5hbWU6ICdQbHV0bycsIG9wZW46IGZhbHNlLCBzaG93bjogdHJ1ZSB9LFxyXG57IGlkOiAxNSwgdHlwZTogJ01ldGFsbHMnLCBuYW1lOiAnQ29wcGVyJywgb3BlbjogZmFsc2UsIHNob3duOiB0cnVlIH0sXHJcbi8vIFRPRE86IHByb2Nlc3NlcywgbXVuZGFuZXMsIGNvbXBvdW5kXHJcbl07XHJcblxyXG5mdW5jdGlvbiBjYXJkc1Jlc2V0KCkge1xyXG5cdGxldCBpID0gMDtcclxuXHRkbyB7XHJcblx0XHRsZXQgcmFuZG9tQ2FyZCA9IGdldFJhbmRvbUNhcmQoKTtcclxuXHRcdGlmICghY2FyZEdyaWQuZmluZChpdGVtID0+IGl0ZW0uaWQgPT09IHJhbmRvbUNhcmQuaWQpKSB7XHJcblx0XHRcdGNhcmRHcmlkW2ldID0gcmFuZG9tQ2FyZDtcclxuXHRcdFx0aSsrO1xyXG5cdFx0fVxyXG5cdH0gd2hpbGUgKGkgPCBDQVJEX0NPTFMgKiBDQVJEX1JPV1MgLyAyKTtcclxuXHRjYXJkR3JpZCA9IG1lc3NDYXJkc0FycmF5KGNhcmRHcmlkLmNvbmNhdChjYXJkR3JpZC5tYXAob2JqZWN0ID0+ICh7IC4uLm9iamVjdCB9KSkpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbWVzc0NhcmRzQXJyYXkoYXJyKSB7XHJcblx0dmFyIGosIHRlbXA7XHJcblx0Zm9yKHZhciBpID0gYXJyLmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pe1xyXG5cdFx0aiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSooaSArIDEpKTtcclxuXHRcdHRlbXAgPSBhcnJbal07XHJcblx0XHRhcnJbal0gPSBhcnJbaV07XHJcblx0XHRhcnJbaV0gPSB0ZW1wO1xyXG5cdH1cclxuXHRyZXR1cm4gYXJyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSYW5kb21DYXJkKCkge1xyXG5cdHJldHVybiBjYXJkc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjYXJkcy5sZW5ndGgpXTtcclxufVxyXG5cclxuZnVuY3Rpb24gcm93Q29sVG9BcnJheUluZGV4KGNvbCwgcm93KSB7XHJcblx0cmV0dXJuIGNvbCArIENBUkRfQ09MUyAqIHJvdztcclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0NhcmRzKCkge1xyXG5cdGZvcihsZXQgZWFjaFJvdyA9IDA7IGVhY2hSb3cgPCBDQVJEX1JPV1M7IGVhY2hSb3crKykge1xyXG5cdFx0Zm9yKGxldCBlYWNoQ29sID0gMDsgZWFjaENvbCA8IENBUkRfQ09MUzsgZWFjaENvbCsrKSB7XHJcblxyXG5cdFx0XHRsZXQgYXJyYXlJbmRleCA9IHJvd0NvbFRvQXJyYXlJbmRleChlYWNoQ29sLCBlYWNoUm93KTtcclxuXHJcblx0XHRcdGlmKGNhcmRHcmlkW2FycmF5SW5kZXhdICYmIGNhcmRHcmlkW2FycmF5SW5kZXhdLnNob3duKSB7XHJcblx0XHRcdFx0aWYgKCFjYXJkR3JpZFthcnJheUluZGV4XS5vcGVuKSB7XHJcblx0XHRcdFx0XHRkcmF3Q2FyZEJhY2soQ0FSRF9XICogZWFjaENvbCArIENBUkRfR0FQICogZWFjaENvbCxcclxuXHRcdFx0XHRcdFx0Q0FSRF9IICogZWFjaFJvdyArIENBUkRfR0FQICogZWFjaFJvdyxcclxuXHRcdFx0XHRcdFx0Q0FSRF9XLCBDQVJEX0gsICdncmF5Jyk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGRyYXdDYXJkRnJvbnQoQ0FSRF9XICogZWFjaENvbCArIENBUkRfR0FQICogZWFjaENvbCxcclxuXHRcdFx0XHRcdFx0Q0FSRF9IICogZWFjaFJvdyArIENBUkRfR0FQICogZWFjaFJvdyxcclxuXHRcdFx0XHRcdFx0Q0FSRF9XLCBDQVJEX0gsICcjZWVlZWVlJywgY2FyZEdyaWRbYXJyYXlJbmRleF0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gZHJhd0NhcmRCYWNrKHgsIHksIHdpZHRoLCBoZWlnaHQsIGNvbG9yKSB7XHJcblx0Y3R4LmJlZ2luUGF0aCgpO1xyXG5cdGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcclxuXHRjdHguZmlsbFJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCk7XHJcblx0Y3R4LmNsb3NlUGF0aCgpO1xyXG5cdGN0eC5maWxsKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdDYXJkRnJvbnQoeCwgeSwgd2lkdGgsIGhlaWdodCwgY29sb3IsIGNhcmQpIHtcclxuXHRjdHguYmVnaW5QYXRoKCk7XHJcblx0Y3R4LmZpbGxTdHlsZSA9IGNvbG9yO1xyXG5cdGN0eC5maWxsUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcclxuXHRjdHguY2xvc2VQYXRoKCk7XHJcblx0Y3R4LmZpbGwoKTtcclxuXHJcblx0Y3R4LnN0cm9rZVN0eWxlID0gJ2JsYWNrJztcclxuXHRjdHgubGluZVdpZHRoID0gNDtcclxuXHJcblx0aWYgKGNhcmQuaWQgPT09IDApIHtcclxuXHRcdC8vIGRyYXcgRWFydGhcclxuXHRcdGN0eC5iZWdpblBhdGgoKTtcclxuXHRcdGN0eC5tb3ZlVG8oeCArIENBUkRfVyAvIDIsIFx0XHRcdFx0XHRcdHkgKyBDQVJEX0ggLSBDQVJEX0ggLyAzLjUpO1xyXG5cdFx0Y3R4LmxpbmVUbyh4ICsgQ0FSRF9XIC8gMTAsIFx0XHRcdFx0XHR5ICsgQ0FSRF9IIC8gMy41KTtcclxuXHRcdGN0eC5saW5lVG8oeCArIENBUkRfVyAtIENBUkRfVyAvIDEwLCBcdHkgKyBDQVJEX0ggLyAzLjUpO1xyXG5cdFx0Y3R4LmNsb3NlUGF0aCgpO1xyXG5cdFx0Y3R4LnN0cm9rZSgpO1xyXG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xyXG5cdFx0Y3R4Lm1vdmVUbyh4ICsgQ0FSRF9XIC8gNSwgXHRcdFx0XHRcdFx0eSArIENBUkRfSCAtIENBUkRfSCAvIDIuNSk7XHJcblx0XHRjdHgubGluZVRvKHggKyBDQVJEX1cgLSBDQVJEX1cgLyA1LCBcdHkgKyBDQVJEX0ggLSBDQVJEX0ggLyAyLjUpO1xyXG5cdFx0Y3R4LnN0cm9rZSgpO1xyXG5cdH1cclxuXHJcblx0aWYgKGNhcmQuaWQgPT09IDEpIHtcclxuXHRcdC8vIGRyYXcgV2F0ZXJcclxuXHRcdGN0eC5iZWdpblBhdGgoKTtcclxuXHRcdGN0eC5tb3ZlVG8oeCArIENBUkRfVyAvIDIsIFx0XHRcdFx0XHRcdHkgKyBDQVJEX0ggLSBDQVJEX0ggLyAzLjUpO1xyXG5cdFx0Y3R4LmxpbmVUbyh4ICsgQ0FSRF9XIC8gMTAsIFx0XHRcdFx0XHR5ICsgQ0FSRF9IIC8gMy41KTtcclxuXHRcdGN0eC5saW5lVG8oeCArIENBUkRfVyAtIENBUkRfVyAvIDEwLCBcdHkgKyBDQVJEX0ggLyAzLjUpO1xyXG5cdFx0Y3R4LmNsb3NlUGF0aCgpO1xyXG5cdFx0Y3R4LnN0cm9rZSgpO1xyXG5cdH1cclxuXHJcblx0aWYgKGNhcmQuaWQgPT09IDIpIHtcclxuXHRcdC8vIGRyYXcgQWlyXHJcblx0XHRjdHguYmVnaW5QYXRoKCk7XHJcblx0XHRjdHgubW92ZVRvKHggKyBDQVJEX1cgLyAyLFx0XHRcdFx0XHQgXHR5ICsgQ0FSRF9IIC8gMy41KTtcclxuXHRcdGN0eC5saW5lVG8oeCArIENBUkRfVyAvIDEwLCBcdFx0XHRcdFx0eSArIENBUkRfSCAtIENBUkRfSCAvIDMuNSk7XHJcblx0XHRjdHgubGluZVRvKHggKyBDQVJEX1cgLSBDQVJEX1cgLyAxMCxcdHkgKyBDQVJEX0ggLSBDQVJEX0ggLyAzLjUpO1xyXG5cdFx0Y3R4LmNsb3NlUGF0aCgpO1xyXG5cdFx0Y3R4LnN0cm9rZSgpO1xyXG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xyXG5cdFx0Y3R4Lm1vdmVUbyh4ICsgQ0FSRF9XIC8gNSwgXHRcdFx0XHRcdFx0eSArIENBUkRfSCAvIDIuNSk7XHJcblx0XHRjdHgubGluZVRvKHggKyBDQVJEX1cgLSBDQVJEX1cgLyA1LCBcdHkgKyBDQVJEX0ggLyAyLjUpO1xyXG5cdFx0Y3R4LnN0cm9rZSgpO1xyXG5cdH1cclxuXHJcblx0aWYgKGNhcmQuaWQgPT09IDMpIHtcclxuXHRcdC8vIGRyYXcgRmlyZVxyXG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xyXG5cdFx0Y3R4Lm1vdmVUbyh4ICsgQ0FSRF9XIC8gMixcdFx0XHRcdFx0IFx0eSArIENBUkRfSCAvIDMuNSk7XHJcblx0XHRjdHgubGluZVRvKHggKyBDQVJEX1cgLyAxMCwgXHRcdFx0XHRcdHkgKyBDQVJEX0ggLSBDQVJEX0ggLyAzLjUpO1xyXG5cdFx0Y3R4LmxpbmVUbyh4ICsgQ0FSRF9XIC0gQ0FSRF9XIC8gMTAsXHR5ICsgQ0FSRF9IIC0gQ0FSRF9IIC8gMy41KTtcclxuXHRcdGN0eC5jbG9zZVBhdGgoKTtcclxuXHRcdGN0eC5zdHJva2UoKTtcclxuXHR9XHJcblxyXG5cdGN0eC5iZWdpblBhdGgoKTtcclxuXHRjdHguZm9udCA9ICcxM3B4IHZlcmRhbmEnO1xyXG5cdGN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJztcclxuXHRjdHguZmlsbFN0eWxlID0gJ2JsYWNrJztcclxuXHRjdHguZmlsbFRleHQoY2FyZC50eXBlLCB4ICsgQ0FSRF9XIC8gMiwgeSArIDMwKTtcclxuXHRjdHguZm9udCA9ICdib2xkIDE1cHggdmVyZGFuYSc7XHJcblx0Y3R4LmZpbGxUZXh0KGNhcmQubmFtZSwgeCArIENBUkRfVyAvIDIsIHkgKyBDQVJEX0ggLSAyMCk7XHJcblx0Y3R4LmNsb3NlUGF0aCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3QWxsKCkge1xyXG5cdGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuXHRkcmF3Q2FyZHMoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlTW91c2VQb3MoZXZ0KSB7XHJcblx0Y29uc3QgcmVjdCA9IGNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHRjb25zdCByb290ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xyXG5cclxuXHRtb3VzZVggPSBldnQuY2xpZW50WCAtIHJlY3QubGVmdCAtIHJvb3Quc2Nyb2xsTGVmdDtcclxuXHRtb3VzZVkgPSBldnQuY2xpZW50WSAtIHJlY3QudG9wIC0gcm9vdC5zY3JvbGxUb3A7XHJcblxyXG5cdGxldCBjYXJkQ29sdW1uR2FwID0gbW91c2VYIC8gKENBUkRfVyArIENBUkRfR0FQKTtcclxuXHRsZXQgY2FyZFJvd0dhcCA9IG1vdXNlWSAvIChDQVJEX0ggKyBDQVJEX0dBUCk7XHJcblx0bGV0IGNhcmRDb2x1bW4gPSBNYXRoLmZsb29yKGNhcmRDb2x1bW5HYXApO1xyXG5cdGxldCBjYXJkUm93ID0gTWF0aC5mbG9vcihjYXJkUm93R2FwKTtcclxuXHJcblx0bGV0IGNvbCA9IGNhcmRDb2x1bW4gKyAoMTAwIC0gQ0FSRF9HQVAgKiAxMDAgLyBDQVJEX1cpIC8gMTAwO1xyXG5cdGxldCByb3cgPSBjYXJkUm93ICsgKDEwMCAtIENBUkRfR0FQICogMTAwIC8gQ0FSRF9IKSAvIDEwMDtcclxuXHRpZiAoY29sIDwgY2FyZENvbHVtbkdhcCB8fCByb3cgPCBjYXJkUm93R2FwKSByZXR1cm47XHJcblxyXG5cdGxldCBjYXJkVW5kZXJDbGljayA9IHJvd0NvbFRvQXJyYXlJbmRleChjYXJkQ29sdW1uLCBjYXJkUm93KTtcclxuXHJcblx0aWYoY2FyZENvbHVtbiA+PSAwICYmIGNhcmRDb2x1bW4gPCBDQVJEX0NPTFMgJiZcclxuXHRcdGNhcmRSb3cgPj0gMCAmJiBjYXJkUm93IDwgQ0FSRF9ST1dTKSB7XHJcblxyXG5cdFx0aWYoY2FyZEdyaWRbY2FyZFVuZGVyQ2xpY2tdKSB7XHJcblx0XHRcdGNvbXBhcmVDYXJkcyhjYXJkVW5kZXJDbGljayk7XHJcblx0XHRcdGRyYXdBbGwoKTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBjb21wYXJlQ2FyZHMoY2FyZCkge1xyXG5cdGlmIChjb21wYXJlLmxlbmd0aCA9PT0gMikgcmV0dXJuO1xyXG5cdGNvbXBhcmUucHVzaChjYXJkKTtcclxuXHRjYXJkR3JpZFtjYXJkXS5vcGVuID0gdHJ1ZTtcclxuXHJcblx0aWYgKGNvbXBhcmUubGVuZ3RoID09PSAyKSB7XHJcblx0XHRpZiAoY2FyZEdyaWRbY29tcGFyZVswXV0uaWQgPT09IGNhcmRHcmlkW2NvbXBhcmVbMV1dLmlkKSB7XHJcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly8gY2FyZEdyaWRbY29tcGFyZVswXV0uc2hvd24gPSBmYWxzZTtcclxuXHRcdFx0XHQvLyBjYXJkR3JpZFtjb21wYXJlWzFdXS5zaG93biA9IGZhbHNlO1xyXG5cdFx0XHRcdGNvbXBhcmUgPSBbXTtcclxuXHRcdFx0XHRkcmF3QWxsKCk7XHJcblx0XHRcdH0sIDEwMDApO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjYXJkR3JpZFtjb21wYXJlWzBdXS5vcGVuID0gZmFsc2U7XHJcblx0XHRcdFx0Y2FyZEdyaWRbY29tcGFyZVsxXV0ub3BlbiA9IGZhbHNlO1xyXG5cdFx0XHRcdGNvbXBhcmUgPSBbXTtcclxuXHRcdFx0XHRkcmF3QWxsKCk7XHJcblx0XHRcdH0sIDEwMDApO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuXHJcbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHRjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB1cGRhdGVNb3VzZVBvcyk7XHJcblxyXG5cdGNhcmRzUmVzZXQoKTtcclxuXHRkcmF3QWxsKCk7XHJcbn0iXX0=
